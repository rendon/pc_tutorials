<!DOCTYPE html>
<html>
<head>
    <title>Tutorial Title</title>
    <meta charset="utf-8" />

    <link rel="stylesheet" href="../style.css">
    <script type="text/javascript" src="../libs/syntaxhighlighter/scripts/shCore.js"></script>
    <script type="text/javascript" src="../libs/syntaxhighlighter/scripts/shBrushCpp.js" ></script>
    <script type="text/javascript" src="../libs/syntaxhighlighter/scripts/shBrushJScript.js"></script>

    <link rel="stylesheet" href="../libs/syntaxhighlighter/styles/shCore.css" />
    <link rel="stylesheet" href="../libs/syntaxhighlighter/styles/shCoreDefault.css" />

    <link rel="stylesheet" href="../libs/syntaxhighlighter/styles/shThemeDefault.css" />
    <script type="text/javascript">SyntaxHighlighter.all();</script>

</head>
<body>
    <header>
        <em>Codechef Tutorials</em>
        <hr>
    </header>
    <content>
        <div id="tutorial-header">
            <div id="tutorial-title">
                <h1>Mathematical Expectation</h1>
            </div>
        </div>


        <div id="table-of-contents">
            <ol>
                <li><a href="#theory">Theory</a></li>
                <li><a href="#problems">Problems</a></li>
                <li><a href="#exercises">Exercises</a></li>
            </ol>
        </div>


        <div id="article">
            <p>"Mathematical Expectation" is one of those few topics that is rarely discussed in details in any curriculum, but is nevertheless very important. This tutorial attempts to throw some light on this topic by discussing few related mathematical and programming problems.</p>

        <h1><a name="theory">Theory</a></h1>
        <p>Mathematical Expectation is an important concept in Probability Theory. Mathematically, for a discrete variable X with probability function P(X),  the expected value E[X] is given by  Σ x<sub>i</sub>P(x<sub>i</sub>) the summation runs over all the distinct values x<sub>i </sub>that the variable can take. For example, for a dice-throw experiment, the set of discrete outcomes is {1, 2, 3, 4, 5, 6} and each of this outcome has the same probability 1 / 6. Hence, the expected value of this experiment will be 1 / 6 * (1 + 2 + 3 + 4 + 5 + 6) = 21 / 6 = 3.5.  For a continuous variable X with probability density function P(x) , the expected value E[X] is given by ∫ xP(x)dx.&nbsp;</p>
        
        <p>It is important to understand that  "expected value" is not same as "most probable value" - rather, it need not even be one of the probable values. For example, in a dice-throw experiment, the expected value, viz 3.5 is not one of the possible outcomes at all.</p>

        <p>The rule of "linearity of of the expectation" says that E[x1 + x2] = E[x1] + E[x2].</p>
        <p>&nbsp;</p>

        <h1><a name="problems">Problems</a></h1>
        <p><b>1. What is the expected number of coin flips for getting a head?</b></p>
        <p><b>Ans:</b></p>
        <p>Let the expected number of coin flips be x. Then we can write an equation for it:
        <ul>
            <li><strong>a</strong>. If the first flip is the head, then we are done. The probability of this event is 1 / 2 and the number of  coin flips for this event is 1.</li>
            <li><strong>b</strong>. If the first flip is the tails, then we have wasted one flip. Since consecutive flips are independent events, the solution in this case can be recursively framed in terms of x --The probability of this event is 1 / 2 and the expected number of coins flips now onwards is x. But we have already wasted one flip, so the total number of flips is x + 1.</li>
        </ul>

        <p>The expected value x is the sum of the expected values of these two cases. Using the rule of linearity of the expectation and the definition of Expected value, we get</p>

        <div class="equation">x = (1 / 2)(1) + (1 / 2) (1 + x)</div>

        <p>Solving, we get x = 2.</p>
        <p>Thus the expected number of coin flips for getting a head is 2.</p>

        <h3>Q2. What is the expected number of coin flips for getting two consecutive heads?</h3>
        <p>Let the expected number of coin flips be x. The case analysis goes as follows:</p>
        
        <ul>
            <li>a. If the first flip is a tails, then we have wasted one flip. The probability of this event is 1 / 2 and the total number of flips required is x + 1.</li>
            <li>b. If the first flip is a heads and second flip is a tails, then we have wasted two flips. The probability of this event is 1 / 4 and the total number of flips required is x + 2.</li>
            <li>c. If the first flip is a heads and second flip is also heads, then we are done. The probability of this event is 1 / 4 and the total number of flips required is 2.</li>
        </ul>

    <p>Adding, the equation that we get is:</p>

    <div class="equation">x = (1 / 2)(x + 1) + (1 / 4)(x + 2) + (1 / 4)2</div>

    <p>Solving, we get x = 6.</p>

    <p>Thus, the expected number of coin flips for getting two consecutive heads is 6.</p>

    <h3>Q3. (Generalization) What is the expected number of coin flips for getting N consecutive heads, given N?</h3>
    <p> Let the exepected number of coin flips be x. Based on previous exercises, we can wind up the whole case analysis in two basic parts:</p>
    
    <ul>
        <li>a) If we get 1st, 2nd, 3rd,...,n'th tail as the first tail in the experiment, then we have to start all over again.</li>
        <li>b) Else we are done.</li>
    </ul>

    <ul>
        <li>For the 1st flip as tail, the part of  the equation is (1 / 2)(x + 1)</li>
        <li>For the 2nd flip as tail, the part of the equation is (1 / 4)(x + 2)</li>
        <li>...</li>
        <li>For the k'th flip as tail, the part of the equation is (1/(2<sup>k</sup>))(x+k)</li>
        <li>...</li>
        <li>For the N'th flip as tail, the part of the equation is (1/(2<sup>N</sup>))(x+N)</li>
    </ul>

    <p>The part of equation corrresponding to case (b) is (1/(2<sup>N</sup>))(N).</p>

    <p>Adding,</p>
    <div class="equation">x = (1 / 2)(x + 1)  +  (1 / 4)(x + 2) + ... +  (1/(2^k))(x+k) + ... + (1/(2^N))(x+N) + (1/(2^N))(N)</div>

    <p>Solving this equation is left as an exercise to the reader. The entire equation can be very easily reduced to the following form:</p>

    <div class="equation">x = 2<sup>N+1</sup>-2</div>

    <p>Thus, the expected number of coin flips for getting N consecutive heads is (2<sup>N+1</sup> - 2).</p>

    <h3>Q4. Candidates are appearing for interview one after other. Probability of  each candidate getting selected is 0.16. What is the expected number of candidates that you will need to interview to make sure that you select somebody?</h3>

    <p>This is very similar to Q1, the only difference is that in this case the coin is biased. (The probability of heads is 0.16 and we are asked to find number of coin flips for getting a heads).</p>

    <p>Let x be the expected number of candidates to be interviewed for a selection. The probability of first candidate getting selected is 0.16 and the total number of interviews done in this case is 1.</p>

    <p>The other case is that the first candidate gets rejected and we start all over again. The probability for that is (1 - 0.16)*(x + 1). The equation thus becomes:

    <p>x = 0.16 + (1 - 0.16)*(x + 1)</p>

    <p>Solving, x = 1 / 0.16, i.e. x = 6.25</p>


        <h3>Q5. (Generalized version of Q4) - The queen of a honey bee nest produces offsprings one-after-other till she produces a male offspring. The probability of produing a male offspring is p. What is the expected number of offsprings required to be produced to produce a male offspring?</h3>
        <p>This is same as the previous question, except that the number 0.16 has been replaced by p. Observe that the equation now becomes</p>

        <p>x = p + (1-p)*(x + 1)</p>
        <p>Solving, x = 1/p</p>
        
        <p>Thus, observe that in the problems where there are two events, where one event is desirable and other is undesirable, and the probability of desirable event is p, then the expected number of trials done to get the desirable event is 1/p.</p>
        </p>Generalizing on the number of events - If there are K events, where one event is desirable and all others are undesirable, and the probability of desirable event is p, then also the expected number of trials done to get the desirable event is 1/p.</p>
        <p>The next question uses this generalization.</p>
        
        <h3>Q6. what is the expected number of dice throws required to get a "four"?</h3>
        <p>Let the expected number of throws be x. The desirable event (getting 'four') has probability 1 / 6 (as each face is equiprobable). There are 5 other undesirable events (K=5). Note that the value of the final answer doesnot depend on K. The answer is thus 1/(1 / 6) i.e. 6.</p>


        <h3>Q7.Candidates are appearing for interview one after other. Probability of  k-th candidate getting selected is 1/(k+1). What is the expected number of candidates that you will need to interview to make sure that you select somebody?</h3>
        <p>The result will be the sum of infinite number of cases.
        <ul>
        <li><strong>case-1:</strong>First candidate gets selected. The probability of this event is 1 / 2 and the number of interviews is 1.</li>
        <li><strong>case-2.</strong>Second candidate gets selected. The probability of this event is 1 / 6 (= 1 / 2 of first candidate not getting selected and 1 / 3 of second candidate getting selected, multiplied together gives 1 / 6) and the number of interviews is 2.</li>
        <li><strong>case-3.</strong>Third candidate gets selected. The probability of this event is 1 / 2 * 2 / 3 * 1 / 4 = 1 / 12 (= first not getting selected and second not getting selected and third getting selected) and the number of interviews is 3.</li>
        <li><strong>...</strong></li>
        <li><strong>case-k.</strong>k'th candidate gets selected. The probability of this event is 1 / 2 * 2 / 3 * 3 / 4 * ... * (k-1)/k * 1/(k+1). (The first k-1 candidates get rejected and the k'th candidate is selected). This evaluates to 1/(k*(k+1)) and the number of interviews is k</li>
        <li><strong>...</strong></li>
        </ul>

        <p>[ Note that similar to problem 4, here we can't just say - if the first candidate is rejected, then we will start the whole process again. This is not correct, because the probabilty of each candidate depends on it's sequence number. Hence sub-experiments are not same as the parent experiment. This means that all the cases must be explicitly considered.]</p>
        <p>The resultant expression will be</p>

        <p>x = 1/(1 * 2) + 2/(2 * 3) + 3/(3 * 4)  + 4/(4 * 5) + ... + k/(k*(k+1)) + ...  = 1 / 2 + 1 / 3 + 1 / 4 + ...</p>

        <p>This is a well-known divergent series, which means that sum doesnot converge, and hence the expectation doesnot exist.</p>

        <h3>Q8: A random permutation P of [1...n] needs to be sorted in ascending order. To do this, at every step you will randomly choose a pair (i,j) where i &lt; j but P[i] &gt; P[j], and swap P[i] with P[j]. What is the expected number of swaps needed to sort permutation in ascending order. (Idea: Topcoder)</h3>

        <p>This is a programming question, and the idea is simple - since each swap has same probability of getting selected, the total number of expected swaps for a permutation P is:</p>

        <p>E[P] = ( 1/cnt )  * Σ (E[P<sub>s</sub>] + 1)</p>

        <p>where cnt is the total number of swaps possible in permutation P, and P<sub>s</sub>is the permutation generated by doing swap 's'. Since all swaps are equiprobable, we simply sum up the expected values of the resultant permutations  (of course add 1 to each to account for the swap done already) and divide the result by the total number of permutations. The base case will be for the array that has been already sorted - and the expected number of permutations for a sorted array is 0.</p>

        <p>Coding this is left as a (trivial) exercise to the reader.</p>

        <h3>Q9. A fair coin flip experiment is carried out N times. What is the expected number of heads?</h3>
        <p>Consider an experiment of flipping a fair coin N times and let the outcomes be represented by the array Z = {a<sub>1</sub>, a<sub>2</sub>,... ,a<sub>n</sub>} where each a<sub>i</sub> is either 1 or 0 depending on whether the outcome was heads or tails respectively. In other words, for each i we have:</p>

        <p>ai =  if the i'th experiment gave head then 1 else 0.</p>
        <p>Hence we have number of heads in z =  a1+ a2 + ... + an</p>
        <p>Hence E[number of heads in z] =  E[a1+ a2 + ... + an] =  E[a1] + E[a2] + ... + E[an]</p>
        <p>Since ai corresponds to a coin-toss experiment, the value of E[ai] is 0.5 for each i. Adding this n times, the expected number of heads in Z comes out to be n/2.</p>

        <h3>Q10: (Bernoulli Trials) n students are asked to choose a number from 1 to 100 inclusive. What is the expected number of students that would choose a single digit number?</h3>

        <p>This question is based on the concept of <b>Bernoulli trials</b>.An experiment is called a Bernoulli trial if it has exactly two outcomes, one of which is desired. For example - flipping a coin,&nbsp; selecting a number from 1 to 100 to get a prime, rolling a dice to get 4 etc. The result of a Bernoulli trial can typically be represented as "yes/no" or "success/failure". We have seen in Q5 above that if the probability of success of a Bernoulli trial is p then the expected number of trials to get a success is 1/p. is</p>

        <p>This question is based on yet another result related to Bernoulli trials - If the probability of a success in a Bernoulli trial is p then the expected number of successes in n trials is n*p. The proof is simple.</p>

        <p>The number of successes in n trials = (if 1st trial is success then 1 else 0) + ... + (if nth trial is success then 1 else 0).</p> 

        <p>The expected value of each bracket is&nbsp; 1*p + 0*(1-p) = p. Thus the expected number of successes in n trials is n*p.</p>


        <p>In the current case, "success" is defined as the experiment that chooses a single digit number. Since all choices are equiprobable, the probability of success is 9 / 100. (There are 9 single digit numbers in 1 to 100). Since there are n students, the expected number of students that would contribute to success (i.e the expected number of successes) is n*9 / 100</p>

        <h3>Q11. What is the expected number of coin flips to ensure that there are atleast N heads?</h3>
        <p>The solution can easily be framed in a recursive manner.</p>
        <p>N heads = if 1st flip is a head then N-1 more heads, else N more heads. The probability of 1st head is 1 / 2.</p>
        <p>Thus E[N] = (1 / 2)(E[N-1]+1)+ (1 / 2)(E[N] + 1)</p>

        <p>Note that each term has 1 added to it to account for the first flip.</p>
        <p>The base case is when N = 1 :</p>
        <p>E[1] = 2 (As discussed in Q2)</p>
        <p>Simplifying the recursive case,</p>
        <p>E[N] = (1 / 2)( E[N-1] +1 + E[N] + 1)<br> = (1 / 2)( E[N-1] + E[N] + 2)<br> =&gt; 2 * E[N]  = ( E[N-1] + E[N] + 2)<br>=&gt; E[N]  = E[N-1] + 2</p>
        <p>Since E[1] = 2, E[2] = 4, E[3] = 6,..., in general E[N] = 2N. Thus, the expected number of coin flips to ensure that there are atleast N heads in 2N.</p>

        <p>The next problem discusses a generalization:</p>

        <h3>Q12. What is the expected number of Bernoulli trials to ensure that there are atleast N successes, if the probability of each success is p?</h3>
        <p>The recursive equation in this case is.</p>
        <p>E[N] = p(E[N-1]+1)+ (1- p)(E[N] + 1)</p>
        <p>Solving, E[N]-E[N-1] = p. Writing a total of N-1 equations:</p>
        <p>E[N]-E[N-1] = 1/p<br>E[N-1]-E[N-2] = 1/p<br>E[N-2]-E[N-3] = 1/p<br>...<br>E[2]-E[1] = 1/p</p>
        <p>Adding them all, E[N] - E[1] = (n-1)/p. But E[1] is 1/p (lemma -1). Hence E[N] = n/p.</p>
        <p>Moral: If probability of success in a Bernoulli trial is p, then the expected number of trials to guaranttee N successes is N/p.</p>

        <p>This completes the discussion on problems on Mathematical Expectation.</p>

        <h1><a name="exercises">Exercises</a></h1>
        <p>Note: Some of these are non-trivial and require concepts not discussed in this tutorial. If you are interested you could read about <a  href="http://www.thelearningpoint.net/home/mathematics/probability---part-2---a-tutorial-on-probability-distributions">probability distribution basics</a>, <a  href="http://www.thelearningpoint.net/home/mathematics/probability---part-3---joint-probability-bivariate-normal-distributions-functions-of-random-variable-transformation-of-random-vectors">more advanced topics such as joint and bivariate distributions and transformations</a> and <a  href="http://www.thelearningpoint.net/home/mathematics/permutations-and-combinations-1">a tutorial on permutations and combinations</a>.</p>

        <ol>
        <li>A game involves you choosing one number (between 1 to 6 inclusive) and then throwing three fair dice simultaneously. If none of the dice shows up the number that you have chosen, you lose $1. If exactly one, two or three dice show up the number that you have chosen, you win $1, $3 or $5 respectively. What is your expected gain?</li>
        <li>There are 10 flowers in a garden, exactly one of which is poisonous. A dog starts eating all these flowers one by one at random. whenever he eats the posionous flower he will die. What is the expected number of flowers he will eat before he will die?</li>
        <li>A bag contains 64 balls of eight different colours, with eight of each colour. What is the expected number of balls you would have to pick (without looking) to select three balls of the same color?</li>
        <li>In a game of fair dice throw, what is the expected number of throws to make sure that all 6 outcomes appear atleast once?</li>
        <li>What is the expected number of Bernoulli trials for getting N consecutive successes, given N, if the probability of each success is p?</li>
    </ol>
    </content>
    <footer>
    </footer>
</body>
</html>
